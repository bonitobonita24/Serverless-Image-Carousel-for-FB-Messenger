<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>__PAGE_TITLE__</title>

  <!-- Facebook / Open Graph meta tags for Messenger compatibility -->
  <meta property="og:title" content="__OG_TITLE__">
  <meta property="og:description" content="__OG_DESCRIPTION__">
  <meta property="og:type" content="website">
  <meta property="og:url" content="__OG_URL__">
  <meta property="og:image" content="__OG_IMAGE__">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="fb:app_id" content="__FB_APP_ID__">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="__OG_TITLE__">
  <meta name="twitter:image" content="__OG_IMAGE__">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <style>
    /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #0a0a0a;
      color: #fff;
      -webkit-tap-highlight-color: transparent;
      -webkit-text-size-adjust: 100%;
      touch-action: pan-y;
    }

    /* â”€â”€ Gallery Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gallery {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gallery-header {
      padding: 12px 16px;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      text-align: center;
      z-index: 10;
      flex-shrink: 0;
    }

    .gallery-header h1 {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .gallery-counter {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.6);
      margin-top: 2px;
    }

    /* â”€â”€ Carousel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .carousel {
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      height: 100%;
      will-change: transform;
    }

    .carousel-slide {
      flex: 0 0 100vw;
      width: 100vw;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      cursor: pointer;
    }

    .carousel-slide img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 8px;
      user-select: none;
      -webkit-user-drag: none;
      pointer-events: none;
    }

    /* â”€â”€ Navigation Arrows â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .nav-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      z-index: 20;
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: white;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, opacity 0.2s;
      opacity: 0.7;
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }

    .nav-btn:hover, .nav-btn:active {
      background: rgba(0, 0, 0, 0.8);
      opacity: 1;
    }

    .nav-btn:disabled {
      opacity: 0.2;
      cursor: default;
    }

    .nav-prev { left: 8px; }
    .nav-next { right: 8px; }

    /* â”€â”€ Dot Indicators â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .dots {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 12px;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      flex-shrink: 0;
      flex-wrap: wrap;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      border: none;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
      padding: 0;
    }

    .dot.active {
      background: #fff;
      transform: scale(1.3);
    }

    /* â”€â”€ Fullscreen Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .fullscreen-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.97);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .fullscreen-overlay.visible {
      display: flex;
      opacity: 1;
    }

    .fullscreen-overlay.fade-in {
      opacity: 1;
    }

    .fullscreen-close {
      position: absolute;
      top: 12px;
      right: 12px;
      z-index: 1010;
      background: rgba(255, 255, 255, 0.15);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .fullscreen-close:hover,
    .fullscreen-close:active {
      background: rgba(255, 255, 255, 0.3);
    }

    .fullscreen-image-container {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 50px 10px 10px;
      overflow: hidden;
      touch-action: pinch-zoom;
    }

    .fullscreen-image-container img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      user-select: none;
      -webkit-user-drag: none;
    }

    .fullscreen-caption {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255, 255, 255, 0.7);
      font-size: 14px;
      text-align: center;
      white-space: nowrap;
    }

    /* â”€â”€ Tap hint â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tap-hint {
      position: absolute;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.15);
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.8);
      pointer-events: none;
      opacity: 1;
      transition: opacity 1s ease;
      z-index: 15;
      white-space: nowrap;
    }

    .tap-hint.hidden {
      opacity: 0;
    }

    /* â”€â”€ Loading / Error states â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .loading-spinner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }

    .error-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      padding: 30px;
      max-width: 400px;
    }

    .error-message h2 {
      font-size: 22px;
      margin-bottom: 12px;
      color: #e74c3c;
    }

    .error-message p {
      font-size: 15px;
      color: rgba(255, 255, 255, 0.6);
      line-height: 1.5;
      margin-bottom: 10px;
    }

    .error-message .debug-hint {
      font-size: 12px;
      color: rgba(200, 200, 200, 0.5);
      margin-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      padding-top: 10px;
    }

    .error-message code {
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 14px;
      color: #fff;
    }

    /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 480px) {
      .nav-btn {
        width: 36px;
        height: 36px;
        font-size: 16px;
      }
      .gallery-header h1 {
        font-size: 16px;
      }
    }

    @media (min-width: 768px) {
      .carousel-slide {
        padding: 20px;
      }
      .carousel-slide img {
        border-radius: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="gallery" id="gallery">
    <!-- Header -->
    <div class="gallery-header">
      <h1 id="galleryTitle">Image Gallery</h1>
      <div class="gallery-counter" id="counter"></div>
    </div>

    <!-- Carousel -->
    <div class="carousel" id="carousel">
      <div class="loading-spinner" id="spinner"></div>
      <div class="carousel-track" id="track">
        <!-- Slides populated dynamically from manifest.json -->
      </div>

      <!-- Nav arrows (hidden until gallery loads) -->
      <button class="nav-btn nav-prev" id="prevBtn" aria-label="Previous image" style="display:none">&#10094;</button>
      <button class="nav-btn nav-next" id="nextBtn" aria-label="Next image" style="display:none">&#10095;</button>

      <!-- Tap hint -->
      <div class="tap-hint" id="tapHint" style="display:none">Tap image to view fullscreen</div>
    </div>

    <!-- Dots -->
    <div class="dots" id="dots"></div>
  </div>

  <!-- Fullscreen overlay -->
  <div class="fullscreen-overlay" id="fullscreen">
    <button class="fullscreen-close" id="fullscreenClose" aria-label="Close fullscreen">&#10005;</button>
    <div class="fullscreen-image-container" id="fullscreenContainer">
      <img id="fullscreenImg" src="" alt="">
    </div>
    <div class="fullscreen-caption" id="fullscreenCaption"></div>
  </div>

  <script>
    (function () {
      'use strict';

      // â”€â”€ Elements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      var track = document.getElementById('track');
      var counter = document.getElementById('counter');
      var dotsContainer = document.getElementById('dots');
      var prevBtn = document.getElementById('prevBtn');
      var nextBtn = document.getElementById('nextBtn');
      var spinner = document.getElementById('spinner');
      var tapHint = document.getElementById('tapHint');
      var galleryTitle = document.getElementById('galleryTitle');

      var fullscreenEl = document.getElementById('fullscreen');
      var fullscreenImg = document.getElementById('fullscreenImg');
      var fullscreenCaption = document.getElementById('fullscreenCaption');
      var fullscreenClose = document.getElementById('fullscreenClose');
      var fullscreenContainer = document.getElementById('fullscreenContainer');

      var slides = [];
      var totalSlides = 0;
      var currentIndex = 0;
      var touchStartX = 0;
      var touchDeltaX = 0;
      var isDragging = false;

      // â”€â”€ Parse client name from URL path â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function getClientInfo() {
        var path = window.location.pathname.replace(/\/+$/, '');
        // Matches: /clients/clientname
        var match = path.match(/\/clients\/([^/]+)/);
        console.log('[DEBUG] pathname:', window.location.pathname, '| cleaned path:', path, '| match:', match);
        if (match) {
          console.log('[DEBUG] Client detected:', match[1]);
          return { name: match[1], basePath: '/clients/' + match[1] };
        }
        console.log('[DEBUG] NO CLIENT MATCH - Pattern expected /clients/clientname');
        return null;
      }

      // â”€â”€ Load manifest and build gallery â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function loadGallery() {
        var client = getClientInfo();

        if (!client) {
          console.log('[DEBUG] loadGallery: No client info, showing error');
          showError('No Client Specified',
            'Please use a URL like:<br><code>/clients/your-client-name</code>');
          return;
        }

        var manifestUrl = client.basePath + '/manifest.json';
        console.log('[DEBUG] Fetching manifest from:', manifestUrl);

        fetch(manifestUrl)
          .then(function (response) {
            console.log('[DEBUG] Manifest response:', response.status, response.statusText);
            if (!response.ok) {
              throw new Error('Manifest not found (HTTP ' + response.status + ')');
            }
            return response.json();
          })
          .then(function (manifest) {
            console.log('[DEBUG] Manifest loaded:', manifest);
            if (!manifest.images || manifest.images.length === 0) {
              throw new Error('No images found in manifest');
            }

            // Update page title
            var title = manifest.title || (manifest.client ? manifest.client + ' Gallery' : 'Image Gallery');
            galleryTitle.textContent = title;
            document.title = title;

            // Update OG tags dynamically
            var firstImgUrl = client.basePath + '/' + manifest.images[0].src;
            updateMetaTag('og:title', title);
            updateMetaTag('og:image', firstImgUrl);
            updateMetaTag('twitter:title', title);
            updateMetaTag('twitter:image', firstImgUrl);

            // Build slides
            buildSlides(manifest.images, client.basePath);
          })
          .catch(function (err) {
            console.error('[DEBUG] Gallery error:', err.message, err);
            showError('Gallery Not Found',
              'Could not load gallery for <strong>' + escapeHtml(client.name) + '</strong>.<br>' +
              '<small>' + escapeHtml(err.message) + '</small>');
          });
      }

      // â”€â”€ Build carousel slides from manifest data â”€â”€â”€â”€
      function buildSlides(images, basePath) {
        track.innerHTML = '';
        dotsContainer.innerHTML = '';

        images.forEach(function (img, i) {
          var slide = document.createElement('div');
          slide.className = 'carousel-slide';
          slide.setAttribute('data-caption', img.caption || img.alt || '');

          var imgEl = document.createElement('img');
          imgEl.src = basePath + '/' + img.src;
          imgEl.alt = img.alt || img.caption || 'Image ' + (i + 1);
          imgEl.loading = i === 0 ? 'eager' : 'lazy';

          slide.appendChild(imgEl);
          track.appendChild(slide);

          // Slide click â†’ fullscreen
          slide.addEventListener('click', function () {
            if (Math.abs(touchDeltaX) < 10) {
              openFullscreen(i);
            }
          });
        });

        slides = Array.from(track.querySelectorAll('.carousel-slide'));
        totalSlides = slides.length;
        currentIndex = 0;

        createDots();

        // Show UI
        spinner.style.display = 'none';
        prevBtn.style.display = '';
        nextBtn.style.display = '';
        tapHint.style.display = '';

        updateCarousel();
        setupTouchEvents();
        setupKeyboardNav();
        dismissHintAfterDelay();
        hideSpinnerWhenLoaded();
      }

      // â”€â”€ Dots â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function createDots() {
        slides.forEach(function (_, i) {
          var dot = document.createElement('button');
          dot.classList.add('dot');
          dot.setAttribute('aria-label', 'Go to image ' + (i + 1));
          if (i === 0) dot.classList.add('active');
          dot.addEventListener('click', function () { goTo(i); });
          dotsContainer.appendChild(dot);
        });
      }

      function updateDots() {
        dotsContainer.querySelectorAll('.dot').forEach(function (dot, i) {
          dot.classList.toggle('active', i === currentIndex);
        });
      }

      // â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function goTo(index) {
        currentIndex = Math.max(0, Math.min(index, totalSlides - 1));
        updateCarousel();
      }

      function next() {
        if (currentIndex < totalSlides - 1) goTo(currentIndex + 1);
      }

      function prev() {
        if (currentIndex > 0) goTo(currentIndex - 1);
      }

      function updateCarousel(transition) {
        if (transition === false) {
          track.style.transition = 'none';
        } else {
          track.style.transition = 'transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
        }
        track.style.transform = 'translateX(-' + (currentIndex * 100) + 'vw)';
        counter.textContent = (currentIndex + 1) + ' / ' + totalSlides;
        prevBtn.disabled = currentIndex === 0;
        nextBtn.disabled = currentIndex === totalSlides - 1;
        updateDots();
      }

      // â”€â”€ Loading spinner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function hideSpinnerWhenLoaded() {
        if (slides.length === 0) return;
        var firstImg = slides[0].querySelector('img');
        
        // Show "Loading images..." text after 2 seconds if still loading
        var loadingHint = setTimeout(function() {
          if (spinner.style.display !== 'none') {
            spinner.innerHTML = '<div style="font-size:14px; color: rgba(255,255,255,0.7); margin-top: 10px;">Loading images...</div>';
          }
        }, 2000);
        
        if (firstImg.complete) {
          clearTimeout(loadingHint);
          spinner.style.display = 'none';
        } else {
          firstImg.addEventListener('load', function () { 
            clearTimeout(loadingHint);
            spinner.style.display = 'none'; 
          });
          // After 8 seconds, force hide spinner regardless
          setTimeout(function () { 
            clearTimeout(loadingHint);
            spinner.style.display = 'none'; 
          }, 8000);
        }
      }

      // â”€â”€ Touch / Swipe â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function setupTouchEvents() {
        var carousel = document.getElementById('carousel');

        carousel.addEventListener('touchstart', function (e) {
          touchStartX = e.touches[0].clientX;
          touchDeltaX = 0;
          isDragging = true;
          track.style.transition = 'none';
        }, { passive: true });

        carousel.addEventListener('touchmove', function (e) {
          if (!isDragging) return;
          touchDeltaX = e.touches[0].clientX - touchStartX;
          var offset = -(currentIndex * window.innerWidth) + touchDeltaX;
          track.style.transform = 'translateX(' + offset + 'px)';
        }, { passive: true });

        carousel.addEventListener('touchend', function () {
          if (!isDragging) return;
          isDragging = false;

          var threshold = window.innerWidth * 0.15;
          if (touchDeltaX < -threshold) {
            next();
          } else if (touchDeltaX > threshold) {
            prev();
          } else {
            updateCarousel();
          }
        });
      }

      // â”€â”€ Keyboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function setupKeyboardNav() {
        document.addEventListener('keydown', function (e) {
          if (fullscreenEl.classList.contains('visible')) {
            if (e.key === 'Escape') closeFullscreen();
            return;
          }
          if (e.key === 'ArrowLeft') prev();
          else if (e.key === 'ArrowRight') next();
          else if (e.key === 'Enter' || e.key === ' ') openFullscreen(currentIndex);
        });
      }

      // â”€â”€ Fullscreen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function openFullscreen(index) {
        var slide = slides[index];
        if (!slide) return;
        var img = slide.querySelector('img');
        var caption = slide.getAttribute('data-caption') || '';

        fullscreenImg.src = img.src;
        fullscreenImg.alt = img.alt;
        fullscreenCaption.textContent = caption;

        fullscreenEl.style.display = 'flex';
        void fullscreenEl.offsetWidth; // Force reflow for transition
        fullscreenEl.classList.add('visible', 'fade-in');

        try {
          var el = document.documentElement;
          if (el.requestFullscreen) el.requestFullscreen();
          else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
        } catch (e) { /* FB Messenger may block this */ }
      }

      function closeFullscreen() {
        fullscreenEl.classList.remove('fade-in');
        setTimeout(function () {
          fullscreenEl.classList.remove('visible');
          fullscreenEl.style.display = 'none';
        }, 300);

        try {
          if (document.exitFullscreen) document.exitFullscreen();
          else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        } catch (e) { /* ignore */ }
      }

      fullscreenClose.addEventListener('click', closeFullscreen);
      fullscreenContainer.addEventListener('click', function (e) {
        if (e.target === fullscreenContainer) closeFullscreen();
      });

      // â”€â”€ Button clicks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      prevBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        prev();
      });
      nextBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        next();
      });

      // â”€â”€ Hint â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function dismissHintAfterDelay() {
        setTimeout(function () {
          tapHint.classList.add('hidden');
        }, 3000);
      }

      // â”€â”€ Resize handling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      var resizeTimer;
      window.addEventListener('resize', function () {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function () {
          updateCarousel(false);
          void track.offsetWidth;
          track.style.transition = 'transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
        }, 100);
      });

      // â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function showError(title, message) {
        spinner.style.display = 'none';
        var el = document.createElement('div');
        el.className = 'error-message';
        var debugHint = '<div class="debug-hint">ðŸ’¡ Open console (F12) for details</div>';
        el.innerHTML = '<h2>' + title + '</h2><p>' + message + '</p>' + debugHint;
        document.getElementById('carousel').appendChild(el);
      }

      function escapeHtml(str) {
        var div = document.createElement('div');
        div.textContent = str;
        return div.innerHTML;
      }

      function updateMetaTag(property, content) {
        var el = document.querySelector('meta[property="' + property + '"]') ||
                 document.querySelector('meta[name="' + property + '"]');
        if (el) el.setAttribute('content', content);
      }

      // â”€â”€ Start â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      loadGallery();
    })();
  </script>
</body>
</html>
